!function(e){var s,a,t,n,i,r,o,l,p,d,c,u,h,f=!1,w=!1,__=wp.i18n.__;function m(){"function"==typeof zxcvbn?(!a.val()||u.hasClass("is-open")?(a.val(a.data("pw")),a.trigger("pwupdate"),k()):(y(),k()),g(),1!==parseInt(r.data("start-masked"),10)?a.attr("type","text"):r.trigger("click"),e("#pw-weak-text-label").text(__("Confirm use of weak password")),"mailserver_pass"!==a.prop("id")&&e(a).trigger("focus")):setTimeout(m,50)}function v(e){r.attr({"aria-label":__(e?"Show password":"Hide password")}).find(".text").text(__(e?"Show":"Hide")).end().find(".dashicons").removeClass(e?"dashicons-hidden":"dashicons-visibility").addClass(e?"dashicons-visibility":"dashicons-hidden")}function g(){r||(r=s.find(".wp-hide-pw")).show().on("click",(function(){"password"===a.attr("type")?(a.attr("type","text"),v(!1)):(a.attr("type","password"),v(!0))}))}function b(s,a,t){var n=e("<div />",{role:"alert"});n.addClass("notice inline"),n.addClass("notice-"+(a?"success":"error")),n.text(e(e.parseHTML(t)).text()).wrapInner("<p />"),s.prop("disabled",a),s.siblings(".notice").remove(),s.before(n)}function y(){var s=e("#pass1").val();if(e("#pass-strength-result").removeClass("short bad good strong empty"),s&&""!==s.trim())switch(wp.passwordStrength.meter(s,wp.passwordStrength.userInputDisallowedList(),s)){case-1:e("#pass-strength-result").addClass("bad").html(pwsL10n.unknown);break;case 2:e("#pass-strength-result").addClass("bad").html(pwsL10n.bad);break;case 3:e("#pass-strength-result").addClass("good").html(pwsL10n.good);break;case 4:e("#pass-strength-result").addClass("strong").html(pwsL10n.strong);break;case 5:e("#pass-strength-result").addClass("short").html(pwsL10n.mismatch);break;default:e("#pass-strength-result").addClass("short").html(pwsL10n.short)}else e("#pass-strength-result").addClass("empty").html("&nbsp;")}function k(){var s=e("#pass-strength-result");if(s.length){var t=s[0];t.className&&(a.addClass(t.className),e(t).is(".short, .bad")?(i.prop("checked")||o.prop("disabled",!0),n.show()):(e(t).is(".empty")?(o.prop("disabled",!0),i.prop("checked",!1)):o.prop("disabled",!1),n.hide()))}}new ClipboardJS(".application-password-display .copy-button").on("success",(function(s){var a=e(s.trigger),t=e(".success",a.closest(".application-password-display"));s.clearSelection(),clearTimeout(h),t.removeClass("hidden"),h=setTimeout((function(){t.addClass("hidden")}),3e3),wp.a11y.speak(__("Application password has been copied to your clipboard."))})),e((function(){var r,h,_,C,x,L=e("#display_name"),S=L.val(),T=e("#wp-admin-bar-my-account").find(".display-name");e("#pass1").val("").on("input pwupdate",y),e("#pass-strength-result").show(),e(".color-palette").on("click",(function(){e(this).siblings('input[name="admin_color"]').prop("checked",!0)})),L.length&&(e("#first_name, #last_name, #nickname").on("blur.user_profile",(function(){var s=[],a={display_nickname:e("#nickname").val()||"",display_username:e("#user_login").val()||"",display_firstname:e("#first_name").val()||"",display_lastname:e("#last_name").val()||""};a.display_firstname&&a.display_lastname&&(a.display_firstlast=a.display_firstname+" "+a.display_lastname,a.display_lastfirst=a.display_lastname+" "+a.display_firstname),e.each(e("option",L),(function(e,a){s.push(a.value)})),e.each(a,(function(t,n){if(n){var i=n.replace(/<\/?[a-z][^>]*>/gi,"");a[t].length&&-1===e.inArray(i,s)&&(s.push(i),e("<option />",{text:i}).appendTo(L))}}))})),L.on("change",(function(){if(_===C){var e=this.value.trim()||S;T.text(e)}}))),r=e("#color-picker"),h=e("#colors-css"),_=e("input#user_id").val(),C=e('input[name="checkuser_id"]').val(),r.on("click.colorpicker",".color-option",(function(){var s,a=e(this);if(!a.hasClass("selected")&&(a.siblings(".selected").removeClass("selected"),a.addClass("selected").find('input[type="radio"]').prop("checked",!0),_===C)){if(0===h.length&&(h=e('<link rel="stylesheet" />').appendTo("head")),h.attr("href",a.children(".css_url").val()),"undefined"!=typeof wp&&wp.svgPainter){try{s=JSON.parse(a.children(".icon_colors").val())}catch(e){}s&&(wp.svgPainter.setColors(s),wp.svgPainter.paint())}e.post(ajaxurl,{action:"save-user-color-scheme",color_scheme:a.children('input[name="admin_color"]').val(),nonce:e("#color-nonce").val()}).done((function(s){s.success&&e("body").removeClass(s.data.previousScheme).addClass(s.data.currentScheme)}))}})),s=e(".user-pass1-wrap, .user-pass-wrap, .mailserver-pass-wrap, .reset-pass-submit"),e(".user-pass2-wrap").hide(),l=e("#submit, #wp-submit").on("click",(function(){f=!1})),o=l.add(" #createusersub"),n=e(".pw-weak"),(i=n.find(".pw-checkbox")).on("change",(function(){o.prop("disabled",!i.prop("checked"))})),(a=e("#pass1, #mailserver_pass")).length?(p=a.val(),1===parseInt(a.data("reveal"),10)&&m(),a.on("input pwupdate",(function(){a.val()!==p&&(p=a.val(),a.removeClass("short bad good strong"),k())}))):a=e("#user_pass"),t=e("#pass2").on("input",(function(){t.val().length>0&&(a.val(t.val()),t.val(""),p="",a.trigger("pwupdate"))})),a.is(":hidden")&&(a.prop("disabled",!0),t.prop("disabled",!0)),u=s.find(".wp-pwd"),x=s.find("button.wp-generate-pw"),g(),x.show(),x.on("click",(function(){f=!0,x.not(".skip-aria-expanded").attr("aria-expanded","true"),u.show().addClass("is-open"),a.attr("disabled",!1),t.attr("disabled",!1),m(),v(!1),wp.ajax.post("generate-password").done((function(e){a.data("pw",e)}))})),s.find("button.wp-cancel-pw").on("click",(function(){f=!1,a.prop("disabled",!0),t.prop("disabled",!0),a.val("").trigger("pwupdate"),v(!1),u.hide().removeClass("is-open"),o.prop("disabled",!1),x.attr("aria-expanded","false")})),s.closest("form").on("submit",(function(){f=!1,a.prop("disabled",!1),t.prop("disabled",!1),t.val(a.val())})),e("#generate-reset-link").on("click",(function(){var s=e(this),a={user_id:userProfileL10n.user_id,nonce:userProfileL10n.nonce};s.parent().find(".notice-error").remove();var t=wp.ajax.post("send-password-reset",a);t.done((function(e){b(s,!0,e)})),t.fail((function(e){b(s,!1,e)}))})),o.on("click",(function(){w=!0})),d=e("#your-profile, #createuser"),c=d.serialize()})),e("#destroy-sessions").on("click",(function(s){var a=e(this);wp.ajax.post("destroy-sessions",{nonce:e("#_wpnonce").val(),user_id:e("#user_id").val()}).done((function(e){a.prop("disabled",!0),a.siblings(".notice").remove(),a.before('<div class="notice notice-success inline" role="alert"><p>'+e.message+"</p></div>")})).fail((function(e){a.siblings(".notice").remove(),a.before('<div class="notice notice-error inline" role="alert"><p>'+e.message+"</p></div>")})),s.preventDefault()})),window.generatePassword=m,e(window).on("beforeunload",(function(){return!0===f?__("Your new password has not been saved."):c===d.serialize()||w?void 0:__("The changes you made will be lost if you navigate away from this page.")})),e((function(){e(".reset-pass-submit").length&&e(".reset-pass-submit button.wp-generate-pw").trigger("click")}))}(jQuery);